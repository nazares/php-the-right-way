---
title:   Composer и Packagist
isChild: true
anchor:  composer_and_packagist
---

## Composer и Packagist {#composer_and_packagist_title}

Composer — рекомендуемый менеджер зависимостей для PHP. Перечислите зависимости вашего проекта в файле `composer.json` и,
с помощью нескольких простых команд Composer автоматически загрузит зависимости вашего проекта и настроит автозагрузку для
вас. Composer аналогичен NPM в мире node.js или Bundler в мире Ruby.

Существует множество библиотек PHP, совместимых с Composer и готовых к использованию в вашем проекте. Эти
"пакеты" перечислены в [Packagist], официальном репозитории совместимых с Composer библиотек PHP.

### Как установить Composer

Самый безопасный способ скачать composer — это [следовать официальной инструкции](https://getcomposer.org/download/).
Оно будет проверять установщик на повреждения и подлинность.
Программа установки устанавливает двоичный файл `composer.phar` в ваш _текущий рабочий каталог_.

Мы рекомендуем устанавливать Composer _глобально_ (напр. единственная копия в `/usr/local/bin`). Для этого выполните следующую команду:

{% highlight console %}
mv composer.phar /usr/local/bin/composer
{% endhighlight %}

**Примечание.** Если вышеуказанное не удается из-за разрешений, добавьте префикс `sudo`.

Чтобы запустить локально установленный Composer, вы должны использовать `php composer.phar`, глобально - просто `composer`.

#### Установка в Windows

Для пользователей Windows самый простой способ приступить к работе — использовать программу установки [ComposerSetup], которая
выполняет глобальную установку и настраивает ваш `$PATH` так, чтобы вы могли просто вызвать `composer` из любой
директории в вашей командной строке.

### Как определить и установить зависимости

Composer отслеживает зависимости вашего проекта в файле с именем `composer.json`. Вы можете управлять этим
вручную если хотите, или использовать сам Composer. Команда `composer require` добавляет зависимость проекта
и если у вас нет файла `composer.json`, он будет создан. Вот пример, который добавляет [Twig]
как зависимость вашего проекта.

{% highlight console %}
composer require twig/twig:^2.0
{% endhighlight %}

В качестве альтернативы, команда `composer init` поможет вам создать полный файл `composer.json`
для вашего проекта. В любом случае, как только вы создали свой файл `composer.json`, вы можете сказать Composer, чтобы
он загрузил и установил свои зависимости в каталог `vendor/`. Это также относится к загруженным вами проектам,
в которых уже есть файл `composer.json`:

{% highlight console %}
composer install
{% endhighlight %}

Затем добавьте эту строку в основной файл PHP вашего приложения; это скажет PHP использовать автозагрузчик
Composer для зависимостей вашего проекта.

{% highlight php %}
<?php
require 'vendor/autoload.php';
{% endhighlight %}

Теперь вы можете использовать зависимости вашего проекта, и они будут автоматически загружаться по запросу.

### Обновление ваших зависимостей

Composer создает файл с именем `composer.lock`, в котором хранится точная версия каждого пакета,
загруженного при первом запуске `composer install`. Если вы делитесь своим проектом с другими, убедитесь,
что файл `composer.lock` включен, чтобы при запуске `composer install` они получили те же версии, что и вы.
Чтобы обновить свои зависимости, запустите `composer update`. Не используйте `composer update` при развертывании,
а только `composer install`, иначе вы можете получить разные версии пакетов в рабочей среде.

Это наиболее полезно, когда вы гибко определяете требования к версии. Например, требование к версии `~1.8` означает
"все, что новее `1.8.0`, но меньше `2.0.x-dev`". Вы также можете использовать подстановочный знак `*`, как в `1.8.*`.
Теперь команда Composer `composer update` обновит все ваши зависимости до самой новой версии, которая соответствует
ограничениям, которые вы определили.

### Уведомления об обновлении

Чтобы получать уведомления о новых выпусках версий, вы можете подписаться на [libraries.io], веб-службу,
которая может отслеживать зависимости и отправлять вам оповещения об обновлениях.

### Проверка ваших зависимостей на предмет проблем с безопасностью

[Local PHP Security Checker] — это инструмент командной строки, который проверит ваш файл `composer.lock`
и сообщит, нужно ли вам обновить какие-либо из ваших зависимостей.

### Обработка глобальных зависимостей с помощью Composer

Composer также может обрабатывать глобальные зависимости и их двоичные файлы. Использование простое - все, что вам нужно
сделать, это добавить к вашей команде префикс «global». Например, если вы хотите установить PHPUnit и сделать его доступным
по всему миру, вы должны выполнить следующую команду:

{% highlight console %}
composer global require phpunit/phpunit
{% endhighlight %}

Это создаст папку `~/.composer`, в которой находятся ваши глобальные зависимости. Чтобы бинарные файлы установленных
пакетов были доступны везде, вы должны добавить папку `~/.composer/vendor/bin` в свою переменную `$PATH`.

* [Узнать больше о Composer]

[Packagist]: https://packagist.org/
[Twig]: https://twig.symfony.com/
[libraries.io]: https://libraries.io/
[Local PHP Security Checker]: https://github.com/fabpot/local-php-security-checker
[Learn about Composer]: https://getcomposer.org/doc/00-intro.md
[ComposerSetup]: https://getcomposer.org/Composer-Setup.exe
