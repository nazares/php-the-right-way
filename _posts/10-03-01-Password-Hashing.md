---
isChild: true
title: Хэширование пароля
anchor:  password_hashing
---

## Хэширование пароля {#password_hashing_title}

В конце концов каждый создает приложение PHP, которое зависит от входа пользователя в систему. Имена пользователей и
пароли хранятся в базе данных и позже используются для аутентификации пользователей при входе в систему.

Важно, чтобы вы правильно делали [_hash_][3] паролей перед их сохранением. Хеширование и шифрование — это [две очень
разные вещи][7], которые часто путают.

Хеширование — необратимая односторонняя функция. Это создает строку фиксированной длины, которую невозможно обратить
вспять. Это означает, что вы можете сравнить хэш с другим, чтобы определить, пришли ли они оба из одной и той же исходной
строки, но вы не можете определить исходную строку. Если пароли не хэшируются и к вашей базе данных обращается
неавторизованная третья сторона, все учетные записи пользователей теперь скомпрометированы.

В отличие от хеширования, шифрование обратимо (если у вас есть ключ). Шифрование полезно в других областях, но это плохая
стратегия для безопасного хранения паролей.

Пароли также должны быть индивидуально [_salted_][5] путем добавления случайной строки к каждому паролю перед хешированием.
Это предотвращает атаки по словарю и использование «радужных таблиц» (обратный список криптографических хэшей для обычных
паролей).

Хеширование и добавление соли жизненно важны, так как часто пользователи используют один и тот же пароль для нескольких
сервисов, а качество пароля может быть низким.

Кроме того, вам следует использовать [специализированный алгоритм_хеширования_пароля][6], а не быструю универсальную
криптографическую хеш-функцию (например, SHA256). Краткий список приемлемых алгоритмов хеширования паролей (по состоянию
на июнь 2018 г.) для использования:

* Argon2 (доступно в PHP 7.2 и новее)
* Scrypt
* **Bcrypt** (PHP предоставляет его для вас; см. ниже)
* PBKDF2 with HMAC-SHA256 or HMAC-SHA512

К счастью, в настоящее время PHP делает это легко.

**Хеширование паролей с `password_hash`**

В PHP 5.5 был введен `password_hash()`. В настоящее время он использует BCrypt, самый сильный алгоритм, который в
настоящее время поддерживается PHP. Однако в будущем он будет обновлен для поддержки большего количества алгоритмов по
мере необходимости. Библиотека `password_compat` была создана для обеспечения прямой совместимости с PHP >= 5.3.7.

Ниже мы хешируем строку, а затем проверяем хеш на новую строку. Поскольку наши две исходные строки различаются
("secret-password" и "bad-password"), этот вход не удастся.

{% highlight php %}
<?php
require 'password.php';

$passwordHash = password_hash('secret-password', PASSWORD_DEFAULT);

if (password_verify('bad-password', $passwordHash)) {
    // Correct Password
} else {
    // Wrong password
}
{% endhighlight %}

`password_hash()` позаботится о добавлении соли для вас. Соль хранится вместе с алгоритмом и "расценивается" как часть
хэша. `password_verify()` извлекает это, чтобы определить, как проверить пароль, поэтому вам не нужно отдельное поле
базы данных для хранения ваших солей.

* [Узнать о `password_hash()`][1]
* [`password_compat` for PHP >= 5.3.7 && < 5.5][2]
* [Узнать о хешировании в отношении криптографии][3]
* [Узнать о salts][5]
* [PHP `password_hash()` RFC][4]

[1]: https://www.php.net/function.password-hash
[2]: https://github.com/ircmaxell/password_compat
[3]: https://wikipedia.org/wiki/Cryptographic_hash_function
[4]: https://wiki.php.net/rfc/password_hash
[5]: https://wikipedia.org/wiki/Salt_(cryptography)
[6]: https://paragonie.com/blog/2016/02/how-safely-store-password-in-2016
[7]: https://paragonie.com/blog/2015/08/you-wouldnt-base64-a-password-cryptography-decoded
